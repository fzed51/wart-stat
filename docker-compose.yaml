services:
  # Frontend service
  frontend:
    build:
      context: .
      dockerfile: Dockerfile.frontend
    container_name: wart-stat-frontend
    volumes:
      - ./app:/app/app:rw
      - ./public:/app/public:rw
      - wart-stat-dist:/app/dist:rw
      - /app/node_modules
    networks:
      - wart-stat-network
    restart: unless-stopped
    labels:
      - "com.example.description=Wart-Stat Frontend"

  # Backend API service
  backend:
    build:
      context: .
      dockerfile: Dockerfile.backend
    container_name: wart-stat-backend
    ports:
      - "80:80"
    networks:
      - wart-stat-network
    restart: unless-stopped
    volumes:
      - ./api:/app/api:rw
      - ./data:/app/data:rw
      - ./data:/app/logs:rw
      - wart-stat-dist:/app/dist:rw
    labels:
      - "com.example.description=Wart-Stat Backend API"

networks:
  wart-stat-network:
    driver: bridge

volumes:
  wart-stat-dist:
    driver: local